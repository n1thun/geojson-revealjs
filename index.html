<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>Geo Spatial Data in MongoDB - Nithun</title>

	<link rel="stylesheet" href="css/reveal.css">
	<link rel="stylesheet" href="css/theme/black.css">

	<!-- Theme used for syntax highlighting of code -->
	<link rel="stylesheet" href="lib/css/zenburn.css">

	<!-- Printing and PDF exports -->
	<script>
		var link = document.createElement('link');
		link.rel = 'stylesheet';
		link.type = 'text/css';
		link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
		document.getElementsByTagName('head')[0].appendChild(link);
	</script>
</head>

<body>
	<div class="reveal">
		<div class="slides">

			<section>
				<h2>Geo Spatial Data in MongoDB</h2>
				<h3>SE 591 SE Studio ii</h3>
				<p>
					<small>Created by <a href="http://www.nithun.com">Nithun Harikrishnan</a> / <a href="http://twitter.com/nithun">@nithun</a></small>
				</p>
			</section>

			<section>
				<h2>What is Mongo DB?</h2>
				<ul>
					<li>Mongo DB is a open-source NoSQL based document  database</li>
					<li>Data is stored in flexible, JSON-like documents</li>
					<li>MonogoDB is a distributed database at its core, So its highly scalable</li>
				</ul>
			</section>

			<section>
				<h2>What is GeoJSON?</h2>
				<ul>
					<li>GeoJSON is a format for encoding a variety of geographic data structures</li>
					<li>GeoJSON extends JSON with a "geometry" section so that you can define coordinates for the particular objects</li>
					<li>GeoJSON supports the following geometry types: Point, LineString, Polygon, MultiPoint, MultiLineString, and MultiPolygon</li>
				</ul>
			</section>

			<section>
				<h2>Why GeoJSON + MongoDB</h2>
				<ul>
					<li>We needed a way to store and retrieve location data for Two2er</li>
					<li>It enables us to perform GeoSpatial filtering and queries like "How many people are in this area?"</li>
					<li>MongoDB has native support for GeoJSON</li>
				</ul>
			</section>

			<section>
				<h2>GeoJSON Structure</h2>
				<ul>
					<li>GeoJSON objects represent a geometry, a feature or a collection of features</li>
					<li>GeoJSON	is a collection of name/value pairs called members</li>
					<li>A member with name "type" must contain a GeoJSON geometry type (ex: Point)</li>
					<li>A member with name "coordinates" must be an array</li>
				</ul>
			</section>

			<section>
				<h2>Legacy 2D point</h2>
				<p>How coordinates are usually stored in Json</p>
				<pre><code class="hljs" data-trim contenteditable>
					{
						name: "Morris Park Bake Shop",
						loc: [-73.856077, 40.848447]
					}
				</code></pre>
			</section>

			<section>
				<h2>GeoJSON point</h2>
				<p>How they are stored as GeoJSON objects</p>
				<pre><code class="hljs" data-trim contenteditable>
					{
					   location: {
					      type: "Point",
					      coordinates: [-73.856077, 40.848447]
					   },
					   name: "Morris Park Bake Shop"
					}
				</code></pre>
				<img height="230" data-src="https://docs.mongodb.com/manual/_images/geospatial-single-point.png">
			</section>

			<section>
				<h3>GeoJSON Polygon</h3>
				<pre><code class="hljs" data-trim contenteditable>
					{
					   geometry: {
					      type: "Polygon",
					      coordinates: [[
					         [ -73.99, 40.75 ],
					         ...
					         [ -73.99, 40.75 ]
					      ]]
					    },
					    name: "Hell's Kitchen"
					}
				</code></pre>
				<img height="230" data-src="https://docs.mongodb.com/manual/_images/geospatial-polygon-hells-kitchen.png">
			</section>

			<section>
				<h2>Using GeoSpatial queries</h2>
				<ul>
					<li>Geospatial queries can use either flat or spherical geometries, depending on both the query and the type of index in use.</li>
					<li>Queries using spherical geometries will be more performant and accurate with a 2dsphere index</li>
					<li>Queries need a geospatial index, create one using:</li>
					<pre><code class="hljs" data-trim contenteditable>
						collection.createIndex({loc:"2dsphere"})
					</code></pre>
				</ul>
			</section>

			<section>
				<h2>$near</h2>
				<p>It returns the points closest to the defined point and sorts the results by distance</p>
				<pre><code class="hljs" data-trim contenteditable>
					db.places.find( {location:
					{ $near :
						{
							$geometry: { type: "Point",
							coordinates: [ -73.9667, 40.78 ] },
							$minDistance: 1000,
							$maxDistance: 5000
						}
					}})
				</code></pre>
			</section>

			<section>
				<h2>$geoWithin</h2>
				<p>You can also query to find all objects contained in a given region.</p>
				<pre><code class="hljs" data-trim contenteditable>
					var neighborhood = db.neighborhoods.findOne(
					{ geometry:
						{ $geoIntersects: { $geometry: {
							type: "Point",
							coordinates: [ -73.93414657, 40.82302903 ] } }
					 } } )

					db.restaurants.find(
					{ location: { $geoWithin: { $geometry: neighborhood.geometry } } }
					)
				</code></pre>
			</section>


			<section>
				<h2>Objects in an area using $geowithin</h2>
					<img data-src="https://docs.mongodb.com/manual/_images/geospatial-all-restaurants.png" height="450">
			</section>


			<section>
				<h2>More Queries</h2>
				<ul>
					<li>$geoSearch - Performs a geospatial query that uses MongoDBâ€™s haystack index functionality</li>
					<li>$geoIntersects - Selects geometries that intersect with a GeoJSON geometry</li>
					<li>$nearSphere	- Returns geospatial objects in proximity to a point on a sphere</li>
				</ul>
			</section>

			<section>
				<h2>Bounding boxes</h2>
				<ul>
					<li>Bounding boxes is a rectangle surounding a certain geographic feature</li>
					<li>These members are named as "bbox"</li>					
				</ul>

				<img data-src="img\bbox.png" alt="Bounding box world">
			</section>

			<section>
				<h2>Support + Tools</h2>
				<ul>
					<li>leaflet.js - an open-source JavaScript library for interactive maps with native geoJson support</li>
					<li>geojson.io - Tool to test and view GeoJSON data</li>
					<li>Github - Also lets you view geoJSON if the file is in .geojson format</li>
				</ul>
			</section>

		</div>
	</div>

	<script src="lib/js/head.min.js"></script>
	<script src="js/reveal.js"></script>

	<script>
		// More info https://github.com/hakimel/reveal.js#configuration
		Reveal.initialize({
			history: true,

			// More info https://github.com/hakimel/reveal.js#dependencies
			dependencies: [{
					src: 'plugin/markdown/marked.js'
				},
				{
					src: 'plugin/markdown/markdown.js'
				},
				{
					src: 'plugin/notes/notes.js',
					async: true
				},
				{
					src: 'plugin/highlight/highlight.js',
					async: true,
					callback: function() {
						hljs.initHighlightingOnLoad();
					}
				}
			]
		});
	</script>
</body>

</html>
